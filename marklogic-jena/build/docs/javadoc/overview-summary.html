<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_144) on Fri Aug 25 15:20:25 PDT 2017 -->
<title>Overview (marklogic-jena 3.0.3 API)</title>
<meta name="date" content="2017-08-25">
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script type="text/javascript" src="script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Overview (marklogic-jena 3.0.3 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 class="title">marklogic-jena 3.0.3 API</h1>
</div>
<div class="header">
<div class="subTitle">
<div class="block">MarkLogic Jena</div>
</div>
<p>See: <a href="#overview.description">Description</a></p>
</div>
<div class="contentContainer">
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Packages table, listing packages, and an explanation">
<caption><span>Packages</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Package</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="com/marklogic/semantics/jena/package-summary.html">com.marklogic.semantics.jena</a></td>
<td class="colLast">
<div class="block">Contains the core class for marklogic-jena,
 <a href="com/marklogic/semantics/jena/MarkLogicDatasetGraph.html" title="class in com.marklogic.semantics.jena"><code>MarkLogicDatasetGraph</code></a>, 
 as well as a Factory and Exceptions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="com/marklogic/semantics/jena/client/package-summary.html">com.marklogic.semantics.jena.client</a></td>
<td class="colLast">
<div class="block">Contains classes that interact with the MarkLogic
 Java Client API.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="com/marklogic/semantics/jena/engine/package-summary.html">com.marklogic.semantics.jena.engine</a></td>
<td class="colLast">
<div class="block">Jena extensions that wire
 MarkLogic functionality into Jena's query processing and
 graph manipulation APIs.</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="contentContainer"><a name="overview.description">
<!--   -->
</a>
<div class="block"><h2>MarkLogic Jena</h2>
<p>
    marklogic-jena enables applications based on Apache Jena 2.13 to use
    MarkLogic as a persistence layer for triples, and as a source for SPARQL
    queries.  In addition to basic support for graph CRUD and SPARQL query and update, 
    marklogic-jena also exposes the following MarkLogic capabilities to the Jena
    framework:
    <ul>
        <li>Transactions</li>
        <li>Variable bindings</li>
        <li>Inference (ruleset configuration)</li>
        <li>Combination of SPARQL with MarkLogic document query</li>
        <li>Optimized pagination of SPARQL result sets</li>
    </ul>
</p>

<h2>Before Starting</h2>
<p>
    Ensure that you have the following information available for a MarkLogic instance:
    <ul>
        <li>hostname</li>
        <li>port of an application server</li>
        <li>credentials to read/write/administer the database as needed</li>
    </ul>
    If you need something to help you configure and deploy MarkLogic
    application servers, try 
    <a href="https://github.com/rjrudin/ml-gradle">ml-gradle</a>.

    Note: If you are starting with 8.0-4 MarkLogic installation on your local
    machine, the configuration of ml-gradle out of the box will set up a test
    server for you.
</p>
<h2>The API</h2>
<p>
Jena uses a <code>com.hp.hpl.jena.sparql.core.DatasetGraph</code> to model a set of RDF graphs.  To create a DatasetGraph that accesses MarkLogic, use <a href="com/marklogic/semantics/jena/MarkLogicDatasetGraph.html" title="class in com.marklogic.semantics.jena"><code>MarkLogicDatasetGraph</code></a>.  You may make a DatasetGraph instance from a <a href="http://github.com/marklogic/java-client-api">Java Client API</a> Database Client, or directly from the five-argument factory method.

<pre>
import com.hp.hpl.jena.sparql.core.DatasetGraph;
import com.marklogic.client.DatabaseClient;
import com.marklogic.client.DatabaseClientFactory;
import com.marklogic.client.DatabaseClientFactory.Authentication;
import com.marklogic.semantics.jena.MarkLogicDatasetGraph;
import com.marklogic.semantics.jena.MarkLogicDatasetGraphFactory;
...

String host = "localhost";
String port = 9999;
String username = "username";
String password = "password";

// either make a DatabaseClient first
DatabseClient client = DatabaseClientFactory.newClient(
    host, port, username, password, Authentication.DIGEST);
    
DatasetGraph dsg;
dsg = MarkLogicDatasetGraphFactory.createDatasetGraph(client);

// or create dsg directly
dsg = MarkLogicDatasetGraphFactory.createDatasetGraph(
    host, port, username, password, Authentication.DIGEST);

// Do things with your DatasetGraph
</pre>
</p>
<h2>Graph operations</h2>
<p>Use Jena's CRUD operations to store, retrieve, merge or delete Graphs on the
MarkLogicDatasetGraph.
<pre>
Node graphNode = NodeFactory.createURI("http://example.org/graphs/charles");

String turtle = "@prefix foaf: <http://xmlns.com/foaf/0.1/> ."
        + "@prefix : <http://example.org/> ."
        +":charles a foaf:Person ; "
        + "        foaf:name \"Charles\" ;"
        + "        foaf:knows :jim ."
        + ":jim    a foaf:Person ;"
        + "        foaf:name \"Jim\" ;"
        + "        foaf:knows :charles .";

// make grpah locally
Graph graph = GraphFactory.createDefaultGraph();
RDFDataMgr.read(graph,  new StringReader(turtle), "", Lang.TURTLE);

// store in MarkLogic
dsg.addGraph(graphNode,  graph);

// Make a triple by hand
Graph moreTriples = GraphFactory.createDefaultGraph();
moreTriples.add(new Triple(
        NodeFactory.createURI("http://example.org/charles"),
        NodeFactory.createURI("http://example.org/hasDog"),
        NodeFactory.createURI("http://example.org/vashko")));

// merge it with the graph in MarkLogic
dsg.mergeGraph(graphNode, moreTriples);

// get the merged graph
Graph retrievedGraph = dsg.getGraph(graphNode);

// remove the graph
dsg.removeGraph(graphNode);

// remove all graphs
dsg.clear();
</pre>
</p>
<pre>
</pre>
<h2>SPARQL Queries</h2>
<p>
<pre>
QueryExecution execution = QueryExecutionFactory.create(
                "PREFIX foaf: <http://xmlns.com/foaf/0.1/> "
                +"select ?aname ?bname where { ?a foaf:knows ?b ."
                + "                    ?a foaf:name ?aname ."
                + "                    ?b foaf:name ?bname }", dsg.toDataset());
int n = 1;
for (ResultSet results = execution.execSelect();
        results.hasNext();
        n++) {
    QuerySolution solution = results.next();
    System.out.println("Solution #" + n ": "
            + solution.get("aname").asLiteral().getString()
            +" knows " 
            + solution.get("bname").asLiteral().getString());
}
dsg.close();
</pre>
</p>
<h2>SPARQL Update</h2>
<p>
<pre>
String insertData = "PREFIX foaf: <http://xmlns.com/foaf/0.1/> "
        + "PREFIX : <http://example.org/> "
        +"INSERT DATA {GRAPH :g1 {"
        + ":charles a foaf:Person ; "
        + "        foaf:name \"Charles\" ;"
        + "        foaf:knows :jim ."
        + ":jim    a foaf:Person ;"
        + "        foaf:name \"Jim\" ;"
        + "        foaf:knows :charles ."
        + "} }";

UpdateRequest update = UpdateFactory.create(insertData);
UpdateProcessor processor = UpdateExecutionFactory.create(update, dsg);
processor.execute();

update = UpdateFactory.create("PREFIX : <http://example.org/> DROP GRAPH :g1");
processor = UpdateExecutionFactory.create(update, dsg);
processor.execute();
dsg.close();
</pre>
</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li class="navBarCell1Rev">Overview</li>
<li>Package</li>
<li>Class</li>
<li><a href="overview-tree.html">Tree</a></li>
<li><a href="deprecated-list.html">Deprecated</a></li>
<li><a href="index-all.html">Index</a></li>
<li><a href="help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev</li>
<li>Next</li>
</ul>
<ul class="navList">
<li><a href="index.html?overview-summary.html" target="_top">Frames</a></li>
<li><a href="overview-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
